{% extends "habitually/layout.html" %}
{% load static %}

{% block body %}
    <span class="test"></span>
    <div class="container">

        {# Check if user is signed in #}
        {% if user.is_authenticated %}

            <!-- Form to add a new habit -->
            <div class="form-container">
                <h4>Add Habit</h4>
                <form action="{% url 'add_habit' %}" method="POST">
                    {% csrf_token %}

                    <div class="form-group">
                        <label>What habit do you want to form?</label>

                        <!-- Textarea for habit name input -->
                        <textarea class="form-control" id="new-habit-textarea" name="habit" rows="1" maxlength="50" required></textarea>

                        <!-- Error message when user tries to add habit that already exists -->
                        <span class="error-message">{{ message }}</span>
                    </div>

                    <div class="form-group">
                        <label>Category:</label>

                        <!-- Drop-down list for categories -->
                        <select class="form-control" name="category" required>
                            <option value="">--Select a category--</option>

                            {# Display each category as a drop-down option #}
                            {% for category in categories %}
                                <option value="{{ category }}">{{ category }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- "Add" button -->
                    <input type="submit" class="btn btn-dark" id="add-button" value="Add">
                </form>
            </div>

            <!-- Weekly calendar view -->
            <div class="calendar">
                <div class="calendar-first-row">
                    <div class="calendar-first-column"></div>
                    <div class="day" id="day0"></div>
                    <div class="day" id="day1"></div>
                    <div class="day" id="day2"></div>
                    <div class="day" id="day3"></div>
                    <div class="day" id="day4"></div>
                    <div class="day" id="day5"></div>
                    <div class="day" id="day6"></div>
                </div>

                <div class="habit-grid">
                    {% for habit in habits %}
                        <div class="calendar-first-column habit {{ habit.category }}">{{ habit }}</div>
                        <div class="checkbox">
                            <input class="form-check-input {{ habit.category }}" type="checkbox" data-habit="{{ habit.name }}" data-daysAgo="6">
                        </div>
                        <div class="checkbox">
                            <input class="form-check-input {{ habit.category }}" type="checkbox" data-habit="{{ habit.name }}" data-daysAgo="5">
                        </div>
                        <div class="checkbox">
                            <input class="form-check-input {{ habit.category }}" type="checkbox" data-habit="{{ habit.name }}" data-daysAgo="4">
                        </div>
                        <div class="checkbox">
                            <input class="form-check-input {{ habit.category }}" type="checkbox" data-habit="{{ habit.name }}" data-daysAgo="3">
                        </div>
                        <div class="checkbox">
                            <input class="form-check-input {{ habit.category }}" type="checkbox" data-habit="{{ habit.name }}" data-daysAgo="2">
                        </div>
                        <div class="checkbox">
                            <input class="form-check-input {{ habit.category }}" type="checkbox" data-habit="{{ habit.name }}" data-daysAgo="1">
                        </div>
                        <div class="checkbox">
                            <input class="form-check-input {{ habit.category }}" type="checkbox" data-habit="{{ habit.name }}" data-daysAgo="0">
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}

    </div>

{% endblock %}